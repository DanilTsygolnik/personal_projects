## Предварительные настройки

Для работы программ на Python в рабочем окружении должны присутствовать следующие пакеты:
- [beautifulsoap4](https://www.crummy.com/software/BeautifulSoup/bs4/doc/#installing-beautiful-soup);
- [requests](https://docs.python-requests.org/en/latest/);

Установка через с помощью `pip`, предпочтительно в отдельное виртуальное окружение.

## Загрузка html-страниц всех уроков отдельного курса 

Использование:
```
python3 download_course.py course_main_page_url /full/path/to/download_dir
```
Передать параметры можно и в pipeline:
```
echo "course_main_page_url /full/path/to/download_dir" | python3 download_course.py
```

[Программа](download_course.py) получает на вход два аргумента: ссылку на главную страницу курса hexlet и абсолютный путь к директории для загрузки файлов. Директория уже должна быть создана, иначе скрипт "ломается", и не все html-страницы будут сохранены на диск.

Производится парсинг страницу курса, выбирает из html-кода блоки `<a>...<a/>` со ссылками и названиями уроков курса. С помощью регулярных выражений из текста заголовков удаляются любые символы, кроме букв и подчеркиваний, на выходе получается название для файла: строка из слов, разделённых `_`. Уроки курса сохраняются на диск html-файлами с соответсвующими названиями.


TODO: нужные директории создает bash-скрипт (см. следующий раздел), но это при загрузке сразу нескольких курсов. Однако, данную функцию разумнее реализовать внутри данной программы - чтобы при работе с URL по одной не приходилось каждый раз вручную вызывать `mkdir ...`.


Здесь использованы и улучшены более [ранние наработки](early_notes.md).

Дополнительные материалы:
- правильная передача тела response в BeautifulSoap -- [пример](https://stackoverflow.com/a/39757879);
- использование `hashlib` в коде -- [пример](https://stackoverflow.com/a/59056837);
- работа с `hashlib`: метод `encode()` на [примерах](https://www.atqed.com/python-hashlib);
- присваивание значения переменных во время вычисления другого выражения (строка `while chunk := f.read(8192):`) -- [статья](https://medium.com/nuances-of-programming/%D0%BA%D0%BE%D0%B3%D0%B4%D0%B0-%D0%B8-%D0%B7%D0%B0%D1%87%D0%B5%D0%BC-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D1%8C-%D0%BE%D0%BF%D0%B5%D1%80%D0%B0%D1%82%D0%BE%D1%80-%D0%B2-python-d2e70bf85a40);
- заменять все знаки, кроме букв и подчеркиваний, из текста для будущих названий файлов -- [пример](https://stackoverflow.com/a/875978);


## Загрузка html-страниц из нескольких курсов одной командой

Использование:
```
cat urls_and_dirs.txt | bash download_several.sh
```

В текстовый файл записаны строки формата `https://.../page /home/user/dir`. URL и path разделены пробелом. Каждая ссылка ведет на главную страницу одного из курсов hexlet. [Скрипт](download_several.sh) построчно считывает входные данные, при необходимости создаются директории для загрузки html-страниц. После создания каталогов каждый URL передается на обработку 
загрузчику уроков курса (см. предыдущий раздел).

Вывод сообщений на экран, производимый в ходе выполнения программы, можно записать в отдельный файл (например, `download_log.txt`), если использовать команду:
```
cat urls_and_dirs.txt | bash download_several.sh 2>&1 | tee download_log.txt
```

Дополнительные материалы:
- [bash-скрипт](download_several.sh): выборка адреса из строки -- см. [example 1](https://www.tutorialkart.com/bash-shell-scripting/bash-split-string/);
- [bash-скрипт](download_several.sh): проверка существования директории и создание, при необходимости, перед вызовом python-скрипта -- [пример](https://www.cyberciti.biz/faq/howto-check-if-a-directory-exists-in-a-bash-shellscript/) конструкции `if ...`;
- запись вывода в окно терминала в отдельный файл -- [пример](https://stackoverflow.com/a/13591423);
